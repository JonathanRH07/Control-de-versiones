CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`%` SQL SECURITY DEFINER VIEW `antiguedad_saldos` AS select `cxc`.`id_cxc` AS `id_cxc`,`cxc`.`id_grupo_empresa` AS `id_grupo_empresa`,`cxc`.`id_sucursal` AS `id_sucursal`,`suc`.`cve_sucursal` AS `cve_sucursal`,`suc`.`nombre` AS `nombre_sucursal`,`cte`.`id_cliente` AS `id_cliente`,`cte`.`cve_cliente` AS `cve_cliente`,`cte`.`razon_social` AS `nombre_cliente`,`cxc`.`razon_social` AS `razon_social`,`vend`.`id_vendedor` AS `id_vendedor`,`vend`.`clave` AS `clave`,`vend`.`nombre` AS `nombre_vendedor`,`corp`.`id_corporativo` AS `id_corporativo`,`corp`.`cve_corporativo` AS `cve_corporativo`,`corp`.`nom_corporativo` AS `nom_corporativo`,`cxc`.`cve_serie` AS `cve_serie`,`cxc`.`fac_numero` AS `fac_numero`,`cxc`.`tipo_cambio_usd` AS `tipo_cambio_usd`,`cxc`.`tipo_cambio_eur` AS `tipo_cambio_eur`,`cxc`.`fecha_emision` AS `fecha_emision`,`cxc`.`fecha_vencimiento` AS `fecha_vencimiento`,`cxc`.`importe_moneda_base` AS `importe_facturado`,`cxc`.`pagos_moneda_base` AS `pagos_facturado`,`cxc`.`saldo_moneda_base` AS `saldo_facturado`,`conf_adm`.`cxcdven1` AS `cxcdven1`,`conf_adm`.`cxcdven2` AS `cxcdven2`,`conf_adm`.`cxcdven3` AS `cxcdven3`,`conf_adm`.`cxcdven4` AS `cxcdven4`,`conf_adm`.`cxcdven5` AS `cxcdven5`,`conf_adm`.`cxcdven6` AS `cxcdven6`,cast(`cxc`.`fecha_vencimiento` as date) AS `date(fecha_vencimiento)`,(case when (curdate() > cast(`cxc`.`fecha_vencimiento` as date)) then (to_days(curdate()) - to_days(`cxc`.`fecha_vencimiento`)) else 0 end) AS `dias_vencidos`,(case when ((to_days(curdate()) - to_days(`cxc`.`fecha_vencimiento`)) <= 0) then `cxc`.`saldo_moneda_base` else 0 end) AS `por_vencer`,(case when ((`conf_adm`.`cxcdven1` <> 0) and (`conf_adm`.`cxcdven1` is not null)) then (case when (((to_days(curdate()) - to_days(`cxc`.`fecha_vencimiento`)) > 0) and ((to_days(curdate()) - to_days(`cxc`.`fecha_vencimiento`)) <= `conf_adm`.`cxcdven1`)) then `cxc`.`saldo_moneda_base` else 0 end) else 0 end) AS `vencimiento_uno`,(case when ((`conf_adm`.`cxcdven2` <> 0) and (`conf_adm`.`cxcdven2` is not null)) then (case when (((to_days(curdate()) - to_days(`cxc`.`fecha_vencimiento`)) > `conf_adm`.`cxcdven1`) and ((to_days(curdate()) - to_days(`cxc`.`fecha_vencimiento`)) <= `conf_adm`.`cxcdven2`)) then `cxc`.`saldo_moneda_base` else 0 end) else (case when ((`conf_adm`.`cxcdven1` <> 0) and (`conf_adm`.`cxcdven1` is not null)) then (case when ((to_days(curdate()) - to_days(`cxc`.`fecha_vencimiento`)) > `conf_adm`.`cxcdven1`) then `cxc`.`saldo_moneda_base` else 0 end) else 0 end) end) AS `vencimiento_dos`,(case when ((`conf_adm`.`cxcdven3` <> 0) and (`conf_adm`.`cxcdven3` is not null)) then (case when (((to_days(curdate()) - to_days(`cxc`.`fecha_vencimiento`)) > `conf_adm`.`cxcdven2`) and ((to_days(curdate()) - to_days(`cxc`.`fecha_vencimiento`)) <= `conf_adm`.`cxcdven3`)) then `cxc`.`saldo_moneda_base` else 0 end) else (case when ((`conf_adm`.`cxcdven2` <> 0) and (`conf_adm`.`cxcdven2` is not null)) then (case when ((to_days(curdate()) - to_days(`cxc`.`fecha_vencimiento`)) > `conf_adm`.`cxcdven2`) then `cxc`.`saldo_moneda_base` else 0 end) else 0 end) end) AS `vencimiento_tres`,(case when ((`conf_adm`.`cxcdven4` <> 0) and (`conf_adm`.`cxcdven4` is not null)) then (case when (((to_days(curdate()) - to_days(`cxc`.`fecha_vencimiento`)) > `conf_adm`.`cxcdven3`) and ((to_days(curdate()) - to_days(`cxc`.`fecha_vencimiento`)) <= `conf_adm`.`cxcdven4`)) then `cxc`.`saldo_moneda_base` else 0 end) else (case when ((`conf_adm`.`cxcdven3` <> 0) and (`conf_adm`.`cxcdven3` is not null)) then (case when ((to_days(curdate()) - to_days(`cxc`.`fecha_vencimiento`)) > `conf_adm`.`cxcdven3`) then `cxc`.`saldo_moneda_base` else 0 end) else 0 end) end) AS `vencimiento_cuatro`,(case when ((`conf_adm`.`cxcdven5` <> 0) and (`conf_adm`.`cxcdven5` is not null)) then (case when (((to_days(curdate()) - to_days(`cxc`.`fecha_vencimiento`)) > `conf_adm`.`cxcdven4`) and ((to_days(curdate()) - to_days(`cxc`.`fecha_vencimiento`)) <= `conf_adm`.`cxcdven5`)) then `cxc`.`saldo_moneda_base` else 0 end) else (case when ((`conf_adm`.`cxcdven4` <> 0) and (`conf_adm`.`cxcdven4` is not null)) then (case when ((to_days(curdate()) - to_days(`cxc`.`fecha_vencimiento`)) > `conf_adm`.`cxcdven4`) then `cxc`.`saldo_moneda_base` else 0 end) else 0 end) end) AS `vencimiento_cinco`,(case when ((`conf_adm`.`cxcdven6` <> 0) and (`conf_adm`.`cxcdven6` is not null)) then (case when (((to_days(curdate()) - to_days(`cxc`.`fecha_vencimiento`)) > `conf_adm`.`cxcdven5`) and ((to_days(curdate()) - to_days(`cxc`.`fecha_vencimiento`)) <= `conf_adm`.`cxcdven6`)) then `cxc`.`saldo_moneda_base` else 0 end) else (case when ((`conf_adm`.`cxcdven5` <> 0) and (`conf_adm`.`cxcdven5` is not null)) then (case when ((to_days(curdate()) - to_days(`cxc`.`fecha_vencimiento`)) > `conf_adm`.`cxcdven5`) then `cxc`.`saldo_moneda_base` else 0 end) else 0 end) end) AS `vencimiento_seis`,(case when ((`conf_adm`.`cxcdven6` <> 0) and (`conf_adm`.`cxcdven6` is not null)) then (case when ((to_days(curdate()) - to_days(`cxc`.`fecha_vencimiento`)) > `conf_adm`.`cxcdven6`) then `cxc`.`saldo_moneda_base` else 0 end) else 0 end) AS `vencimiento_siete`,`cxc`.`estatus` AS `estatus` from ((((((`suite_mig_demo`.`ic_glob_tr_cxc` `cxc` join `suite_mig_demo`.`ic_cat_tr_cliente` `cte` on((`cxc`.`id_cliente` = `cte`.`id_cliente`))) join `suite_mig_demo`.`ic_cat_tr_sucursal` `suc` on((`cxc`.`id_sucursal` = `suc`.`id_sucursal`))) join `suite_mig_demo`.`ic_cat_tr_vendedor` `vend` on((`cxc`.`id_vendedor` = `vend`.`id_vendedor`))) left join `suite_mig_demo`.`ic_cat_tr_corporativo` `corp` on((`cte`.`id_corporativo` = `corp`.`id_corporativo`))) join `suite_mig_conf`.`st_adm_tr_grupo_empresa` `gpo_emp` on((`cxc`.`id_grupo_empresa` = `gpo_emp`.`id_grupo_empresa`))) join `suite_mig_conf`.`st_adm_tr_config_admin` `conf_adm` on((`gpo_emp`.`id_empresa` = `conf_adm`.`id_empresa`)));
